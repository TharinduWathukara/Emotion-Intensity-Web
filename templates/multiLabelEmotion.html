{% extends 'layout.html' %}


{% block body %}

<h1>Multi-Label Emotion Classification</h1>
  <form action="" method="POST">
    <div class="form-group">
      <label>Text to analyze</label>
      <!-- <input type="textarea" name="text" class="form-control" value="Input Text To Classify"> -->
      <textarea class="form-control rounded-0" id="exampleFormControlTextarea2" rows="3" name="text"></textarea>
    </div>
    <button type="submit" class="btn btn-primary">Analyze</button>
  </form>

  {% if multiLabel: %}
  <div class="container" style="padding:2% 5%">
    <!-- <h2 class="font-italic font-weight-light">{{ text }}</h2> -->
    <div class="row"  style="padding:1% 15%">
      {% if  ( multiLabel['anger'] == 1): %}
      <div class="col">
        <p class="font-weight-bold text-center">Anger</p>
        <img style="border-radius: 50%;" class="img-fluid hoverable" src="{{url_for('static', filename='angry.png')}}" alt="Anger">
        <!-- <p class="font-weight-bold text-center">90%</p> -->
      </div>
      {% else: %}
      <div class="col" style="opacity:0.05">
        <p class="font-weight-bold text-center">Anger</p>
        <img style="border-radius: 50%;" class="img-fluid hoverable" src="{{url_for('static', filename='angry.png')}}" alt="Anger">
        <!-- <p class="font-weight-bold text-center">90%</p> -->
      </div>
      {% endif %}
  
      {% if ( multiLabel['fear']  == 1): %}
      <div class="col">
        <p class="font-weight-bold text-center">Fear</p>
        <img style="border-radius: 50%;" class="img-fluid hoverable" src="{{url_for('static', filename='fear.png')}}" alt="Fear">
        <!-- <p class="font-weight-bold text-center">90%</p> -->
      </div>
      {% else: %}
      <div class="col" style="opacity:0.05">
          <p class="font-weight-bold text-center">Fear</p>
        <img style="border-radius: 50%;" class="img-fluid hoverable" src="{{url_for('static', filename='fear.png')}}" alt="Fear">
        <!-- <p class="font-weight-bold text-center">90%</p> -->
      </div>
      {% endif %}
  
      {% if ( multiLabel['joy']  == 1): %}
      <div class="col">
        <p class="font-weight-bold text-center">Happiness</p>
        <img style="border-radius: 50%;" class="img-fluid hoverable" src="{{url_for('static', filename='happy.png')}}" alt="Happiness">
        <!-- <p class="font-weight-bold text-center">90%</p> -->
      </div>
      {% else: %}
      <div class="col" style="opacity:0.05">
          <p class="font-weight-bold text-center">Happiness</p>
        <img style="border-radius: 50%;" class="img-fluid hoverable" src="{{url_for('static', filename='happy.png')}}" alt="Happiness">
        <!-- <p class="font-weight-bold text-center">90%</p> -->
      </div>
      {% endif %}
  
      {% if ( multiLabel['sadness']  == 1): %}
      <div class="col">
        <p class="font-weight-bold text-center">Sadness</p>
        <img style="border-radius: 50%;" class="img-fluid hoverable" src="{{url_for('static', filename='sad.png')}}" alt="Sadness">
        <!-- <p class="font-weight-bold text-center">90%</p> -->
      </div>
      {% else: %}
      <div class="col" style="opacity:0.05">
        <p class="font-weight-bold text-center">Sadness</p>
        <img style="border-radius: 50%;" class="img-fluid hoverable" src="{{url_for('static', filename='sad.png')}}" alt="Sadness">
        <!-- <p class="font-weight-bold text-center">90%</p> -->
      </div>
      {% endif %}
    </div>
  </div>

  <div id="container" style="width: 68%; margin:0 auto; ">
		<canvas id="canvas"></canvas>
  </div>
  <br><br>

  <script>
  
  document.getElementById('exampleFormControlTextarea2').value = "{{ text }}";
  
  var EMOTIONS = ['Anger', 'Fear', 'Happiness', 'Sadness'];
		var barChartData = {
			labels: ['Anger', 'Fear', 'Happiness', 'Sadness'],
			datasets: [{
        label:'Emotion Intensities',
				backgroundColor: '#6823BD',
				borderColor: '#6823BD',
				borderWidth: 1,
				data: {{ intensity }}
			}]

		};

		window.onload = function() {
			var ctx = document.getElementById('canvas').getContext('2d');
			window.myBar = new Chart(ctx, {
				type: 'bar',
				data: barChartData,
				options: {
					responsive: true,
					legend: {
						position: 'top',
					},
					title: {
						display: true,
						text: 'Emotion Intensities'
					},
          scales: {
            yAxes: [{
              display: true,
              ticks: {
                beginAtZero: true,
                steps: 10,
                stepValue: 10,
                max: 100
              }
            }]
          },
          tooltips: {
              enabled: true
          },
          hover: {
              animationDuration: 1
          },
          animation: {
              duration: 1,
              onComplete: function () {
                  var chartInstance = this.chart,
                      ctx = chartInstance.ctx;
                  ctx.textAlign = 'center';
                  ctx.fillStyle = "rgba(0, 0, 0, 1)";
                  ctx.textBaseline = 'bottom';

                  this.data.datasets.forEach(function (dataset, i) {
                      var meta = chartInstance.controller.getDatasetMeta(i);
                      meta.data.forEach(function (bar, index) {
                          var data = dataset.data[index];
                          ctx.fillText(data, bar._model.x, bar._model.y - 5);

                      });
                  });
              }
          }
				}
			});

		};

  </script>
  
  {% endif %}

{% endblock %}